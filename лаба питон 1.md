import csv

vsevo = dlina = fnaf = 0
count = 1
bibli = []

#по заданию надо ввести поиск по автору, введём его

search = input('Искать: ') #теперь откроем файл
with open('books.csv', 'r', encoding = 'windows-1251') as f:
    
#читаем файл как таблицу

    table = csv.reader(f, delimiter = ';')

#найдём количество записей (строк) в таблице

    for row in list(table):
        vsevo += 1 
#каждую 470-ую запись оформим в виде библиографической ссылки по образцу
        if (vsevo % 470 == 0) and (count < 21):
            bibli.append(row[3] + '. ' + '"' + row[1] + '"' + ' - ' + row[6][6:10])
            count += 1 
#таких ссылок будет 20
            
#теперь найдём количество записей, где название книги больше 30 символов
        if len(row[1]) > 30:
            dlina += 1
#теперь начнём работать с поиском по автору
#если графа "Автор" соотвествует разыскиваемому, то рассмотрим стоимость книги
#если меньше 150 рублей, то выводим
        lower_case = row[3].lower()
        index = lower_case.find(search.lower())
        if (index != -1):
            if float(row[7]) < 150:
                print(row[1])
            fnaf = 1
#если ни одной книги по запросу не найдено, то так и выводим
    if fnaf == 0:
        print('Ничего не найдено')
#выведем всё, что нашли по заданию
    print('Количество записей:', vsevo - 1)
    print('Количество записей, где строка "Название" длиннее 30 символов:', dlina)
    print(bibli)

f.close() #завершаем работу закрытием файла
